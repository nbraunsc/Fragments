#this is where i will need to import my package, need to check name
import nicolefragment
from nicolefragment import *
from nicolefragment import Molecule, MIM

from pyscf import gto, scf, ci, cc, mp, hessian, lib, grad
from pyscf.geomopt.berny_solver import optimize
from berny import Berny, geomlib


aspirin = Molecule.Molecule()
aspirin.initalize_molecule('aspirin')     
energy_MIM = MIM.do_MIM1(1, 'RHF', 'sto-3g', aspirin, 'aspirin')[0]

mol = gto.Mole(atom= '''
C 2.23930000000000007 -0.379099999999999993 0.263000000000000012
C 0.842400000000000038 1.92310000000000003 -0.4249
C 2.87089999999999979 0.845600000000000018 0.272199999999999998
C 2.17510000000000003 1.99350000000000005 -0.0703000000000000014
C -3.48380000000000001 0.495300000000000018 -0.0895999999999999991
C 0.891000000000000014 -0.464700000000000002 -0.0938999999999999974
C 0.190799999999999997 0.699100000000000055 -0.44019999999999998
O -0.963300000000000045 -1.84250000000000003 -0.418499999999999983
O -1.65310000000000001 0.888900000000000023 1.34060000000000001
O 0.885700000000000043 -2.88830000000000009 0.226700000000000013
C 0.208999999999999991 -1.77200000000000002 -0.106899999999999995
C -2.01849999999999996 0.68530000000000002 0.207100000000000006
O -1.11890000000000001 0.628499999999999948 -0.788599999999999968
H 0.396199999999999997 -3.72190000000000021 0.203499999999999986
H 2.78670000000000018 -1.27190000000000003 0.526800000000000046
H 0.306900000000000006 2.82240000000000002 -0.691100000000000048
H 3.91299999999999981 0.910800000000000054 0.548200000000000021
H 2.67810000000000015 2.94919999999999982 -0.0604000000000000023
H -3.73600000000000021 -0.562300000000000022 -0.0120000000000000002
H -4.07629999999999981 1.06370000000000009 0.627299999999999969
H -3.69879999999999987 0.847099999999999964 -1.09860000000000002
                        ''',
                        basis='sto-3g')

mol.build()
myHF = scf.RHF(mol)
mol1 = optimize(myHF)
opte = scf.RHF(mol1).kernel()

mol = gto.Mole()
mol.atom ='''
C 0.164099999999999996 -1.37260000000000004 -0.00020000000000000001
C -1.10660000000000003 -0.828400000000000025 0.000100000000000000005
C -1.27069999999999994 0.544200000000000017 -0
C -0.164099999999999996 1.37260000000000004 0
C 1.10660000000000003 0.828400000000000025 0.000599999999999999947
C 1.27069999999999994 -0.544200000000000017 -0.000699999999999999993
H 0.292300000000000004 -2.44490000000000007 0.00440000000000000027
H -1.97120000000000006 -1.47560000000000002 0
H -2.26350000000000007 0.96930000000000005 -0.00050000000000000001
H -0.292300000000000004 2.44490000000000007 -0.000800000000000000038
H 1.97120000000000006 1.47560000000000002 -0.000100000000000000005
H 2.26350000000000007 -0.96930000000000005 0.00020000000000000001
'''
mol.basis = 'sto-3g'
mol.build()
myHFben = scf.RHF(mol)
mol2 = optimize(myHFben)
opte_ben = scf.RHF(mol2).kernel()

benzene = Molecule.Molecule()
benzene.initalize_molecule('benzene')
energy_MIMben = MIM.do_MIM1(1, 'RHF', 'sto-3g', benzene, 'benzene')[0]

aspirin_diff = energy_MIM - opte
rms_aspirin = (aspirin_diff**2)/2
print(aspirin_diff, "aspirin difference")
print(rms_aspirin, "RMS for aspirin")

benzene_diff = energy_MIMben - opte_ben
rms_benzene = (benzene_diff**2)/2
print(benzene_diff, "benzene difference")
print(rms_benzene, "RMS for benzene")

